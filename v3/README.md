# 股票预测模型训练系统

这是一个基于LightGBM的股票价格预测系统，使用动态障碍位和滚动时间窗口训练方法。

## 功能特点

1. **动态障碍位计算**：基于ATR指标动态计算上下障碍位
2. **滚动时间窗口训练**：使用滚动窗口方法训练模型，模拟实际交易场景
3. **多标签分类**：将股票价格变化分为上涨、下跌、持平三类
4. **滞后特征工程**：使用历史数据创建滞后特征
5. **日志记录与结果解析**：完整的日志记录和结果解析功能

## 代码结构

- `train.py`：主训练脚本
- `prepare.py`：数据准备模块
- `metric.py`：技术指标计算模块
- `parse_results.py`：日志解析和结果导出脚本

## 使用方法

### 1. 训练模型

```bash
python train.py
```

训练过程中会输出详细的日志信息，并将日志保存到`logs/training.log`文件中。

### 2. 解析训练结果

```bash
python parse_results.py
```

该脚本会解析日志文件并生成以下文件：
- `results/window_results_*.csv`：各窗口的详细结果
- `results/summary_stats_*.csv`：汇总统计信息
- `results/training_results_*.json`：完整的训练结果（JSON格式）

## 日志格式说明

日志文件包含以下关键信息：
1. 训练和预测时间窗口
2. 训练样本数量和标签分布
3. 各窗口的评估指标（准确率、标签1准确率、F1分数）
4. 汇总统计信息

## 结果解析

解析脚本会提取以下关键指标：
- 各窗口的准确率、标签1准确率、F1分数
- 平均准确率、平均标签1准确率、平均F1分数
- 训练和预测时间窗口信息

这些指标可以帮助分析模型在不同时间窗口的表现，以及对上涨行情的预测能力。